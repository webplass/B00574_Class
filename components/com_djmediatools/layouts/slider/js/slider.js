/**
 * @version $Id: slider.js 99 2017-08-04 10:55:30Z szymon $
 * @package DJ-MediaTools
 * @subpackage DJ-MediaTools slider layout
 * @copyright Copyright (C) 2017 DJ-Extensions.com, All rights reserved.
 * @license DJ-Extensions.com Proprietary Use License
 * @author url: http://dj-extensions.com
 * @author email contact@dj-extensions.com
 * @developer Szymon Woronowski - szymon.woronowski@design-joomla.eu
 *
 */
(function($){var H=window.DJImageSlider=window.DJImageSlider||function(F,G){this.init=function(o,q){var r=$('#djslider-loader'+o.id),djslider=$('#djslider'+o.id).css('opacity',0),slider=$('#slider'+o.id),cssTransition=support('transition');var t=$('#slider'+o.id).children('li');var u=o.slide_size;var w=o.visible_slides;var x=u*t.length;var y=t.length-w;var z=0;var A=q.auto;var B=0;var C=false;var D=[];switch(o.slider_type){case'up':slider.css('position','relative');slider.css('top',0);slider.css('height',x);if(cssTransition)slider.css(cssTransition,'top '+q.duration+'ms '+q.css3transition);break;case'down':slider.css('position','absolute');slider.css('bottom',0);slider.css('height',x);if(cssTransition)slider.css(cssTransition,'bottom '+q.duration+'ms '+q.css3transition);break;case'left':slider.css('position','relative');slider.css('left',0);slider.css('width',x);if(cssTransition)slider.css(cssTransition,'left '+q.duration+'ms '+q.css3transition);break;case'right':slider.css('position','relative');slider.css('right',0);slider.css('float','right');slider.css('width',x);if(cssTransition)slider.css(cssTransition,'right '+q.duration+'ms '+q.css3transition);break;case'fade':case'ifade':default:t.css('position','absolute');t.css('top',0);t.css('left',0);slider.css('width',u);t.css('opacity',0);t.css('visibility','hidden');$(t[0]).css('opacity',1);$(t[0]).css('visibility','visible');if(cssTransition)t.css(cssTransition,'opacity '+q.duration+'ms '+q.css3transition);break}if(o.show_arrows>0){$('#next'+o.id).on('click',function(){if(o.direction=='right')prevSlide();else nextSlide();B=1}).on('keydown',function(a){var b=a.which;if(b==13||b==32){if(o.direction=='right')prevSlide();else nextSlide();B=1;a.preventDefault();a.stopPropagation()}});$('#prev'+o.id).on('click',function(){if(o.direction=='right')nextSlide();else prevSlide();B=1}).on('keydown',function(a){var b=a.which;if(b==13||b==32){if(o.direction=='right')nextSlide();else prevSlide();B=1;a.preventDefault();a.stopPropagation()}})}if(o.show_buttons>0){$('#play'+o.id).on('click',function(){changeNavigation();A=1;B=0}).on('keydown',function(a){var b=a.which;if(b==13||b==32){changeNavigation();A=1;B=0;a.preventDefault();a.stopPropagation()}});$('#pause'+o.id).on('click',function(){changeNavigation();A=0}).on('keydown',function(a){var b=a.which;if(b==13||b==32){changeNavigation();A=0;a.preventDefault();a.stopPropagation()}})}r.on('mouseenter',function(){B=q.pause_autoplay}).on('mouseleave',function(){r.removeClass('focused');B=0}).on('focus',function(){r.addClass('focused');r.trigger('mouseenter');B=1}).on('keydown',function(e){var a=e.which;if(a==37||a==39){if(a==39){if(o.direction=='right')prevSlide();else nextSlide()}else{if(o.direction=='right')nextSlide();else prevSlide()}e.preventDefault();e.stopPropagation()}});$('.djslider-end').on('focus',function(){r.trigger('mouseleave')});r.djswipe(function(a,b){if(b.x<100||b.y>30){return}if(a.x=="left"){if(o.direction=='right')prevSlide();else nextSlide()}else if(a.x=="right"){if(o.direction=='right')nextSlide();else prevSlide()}});if($('#cust-navigation'+o.id).length){var E=$('#cust-navigation'+o.id).find('.load-button');E.each(function(c){var d=$(this);d.on('click',function(e){if(!C&&!d.hasClass('load-button-active')){loadSlide(c)}}).on('keydown',function(a){var b=a.which;if(b==13||b==32){if(!C&&!d.hasClass('load-button-active')){loadSlide(c)}a.preventDefault();a.stopPropagation()}});if(c>y)d.css('display','none')})}function getSize(a){var b={'x':a.width(),'y':a.height()};if((b.x==0||b.y==0)&&a.is(':hidden')){var c=a.parent(),child,width;while(c.is(':hidden')){child=c;c=c.parent()}width=c.width();if(child){width-=parseInt(child.css('margin-left'));width-=parseInt(child.css('margin-right'));width-=parseInt(child.css('border-left-width'));width-=parseInt(child.css('border-right-width'));width-=parseInt(child.css('padding-left'));width-=parseInt(child.css('padding-right'))}var d=a.clone();d.css({'position':'absolute','visibility':'hidden','max-width':width});$(document.body).append(d);b={'x':d.width(),'y':d.height()};d.remove()}return b}function responsive(){var c=r.parent();var d=getSize(c).x;var e=parseInt(djslider.css('max-width'));var f=getSize(djslider);var g=f.x;if(g>d){g=d}else if(g<=d&&(!e||g<e)){g=(d>e?e:d)}if(!D[w])D[w]=f.x/f.y;var h=D[w];var i=g/h;djslider.css('width',g);djslider.css('height',i);var j=o.slider_type;switch(j){case'up':case'down':var k=parseInt($(t[0]).css(j=='up'?'margin-bottom':'margin-top'));u=(i+k)/w;x=t.length*u+t.length;slider.css('height',x);t.css('width',g);t.css('height',u-k);slider.css(j=='up'?'top':'bottom',-u*z);break;case'left':case'right':var k=parseInt($(t[0]).css(j=='left'?'margin-right':'margin-left'));var l=Math.ceil(g/(o.slide_size+k));if(l!=w){w=(l>o.visible_slides?o.visible_slides:l);y=t.length-w;if($('#cust-navigation'+o.id).length){var m=$('#cust-navigation'+o.id).find('.load-button');m.each(function(a){var b=$(this);if(a>y)b.css('display','none');else b.css('display','')})}if(!D[w])D[w]=(w*u-k)/f.y;h=D[w];i=g/h;djslider.css('height',i)}u=(g+k)/w;x=t.length*u+t.length;slider.css('width',x);t.css('width',u-k);t.css('height',i);slider.css(j,-u*z);if(z>y)loadSlide(y);break;case'fade':case'ifade':default:slider.css('width',g);t.css('width',g);t.css('height',i);break}if(o.show_buttons||o.show_arrows){var n,nav_pos,padding,buttons_margin;n=$('#navigation'+o.id).position().top;if(n<0){r.css('padding-top',-n);r.css('padding-bottom',0)}else{buttons_height=0;if(o.show_arrows>0){buttons_height=getSize($('#next'+o.id)).y;buttons_height=Math.max(buttons_height,getSize($('#prev'+o.id)).y)}if(o.show_buttons>0){buttons_height=Math.max(buttons_height,getSize($('#play'+o.id)).y);buttons_height=Math.max(buttons_height,getSize($('#pause'+o.id)).y)}padding=n+buttons_height-i;if(padding>0){r.css('padding-top',0);r.css('padding-bottom',padding)}else{r.css('padding-top',0);r.css('padding-bottom',0)}}buttons_margin=parseInt($('#navigation'+o.id).css('margin-left'))+parseInt($('#navigation'+o.id).css('margin-right'));if(buttons_margin<0&&getSize($(window)).x<getSize($('#navigation'+o.id)).x-buttons_margin){$('#navigation'+o.id).css('margin-left',0);$('#navigation'+o.id).css('margin-right',0)}}updateTabindex()}function updateActiveButton(c){if($('#cust-navigation'+o.id).length)E.each(function(a){var b=$(this);b.removeClass('load-button-active');if(a==c)b.addClass('load-button-active')})}function nextSlide(){if(z<y)loadSlide(z+1);else loadSlide(0)}function prevSlide(){if(z>0)loadSlide(z-1);else loadSlide(y)}function loadSlide(a){if(z==a)return;if(o.slider_type=='fade'||o.slider_type=='ifade'){if(C)return;C=true;var b=z;z=a;makeFade(b)}else{z=a;switch(o.slider_type){case'up':if(cssTransition)slider.css('top',-u*z);else slider.animate({top:-u*z},q.duration,q.transition);break;case'down':if(cssTransition)slider.css('bottom',-u*z);else slider.animate({bottom:-u*z},q.duration,q.transition);break;case'left':if(cssTransition)slider.css('left',-u*z);else slider.animate({left:-u*z},q.duration,q.transition);break;case'right':if(cssTransition)slider.css('right',-u*z);else slider.animate({right:-u*z},q.duration,q.transition);break}}updateTabindex();updateActiveButton(z)}function makeFade(a){$(t[z]).css('visibility','visible');if(cssTransition){$(t[z]).css('opacity',1);$(t[a]).css('opacity',0)}else{$(t[z]).animate({opacity:1},q.duration,q.transition);$(t[a]).animate({opacity:0},q.duration,q.transition)}setTimeout(function(){$(t[a]).css('visibility','hidden');C=false},q.duration)}function changeNavigation(){if(A){$('#pause'+o.id).css('display','none');$('#play'+o.id).css('display','block').focus()}else{$('#play'+o.id).css('display','none');$('#pause'+o.id).css('display','block').focus()}}function slidePlay(){setTimeout(function(){if(A&&!B)nextSlide();slidePlay()},q.delay)}function sliderLoaded(){r.css('background','none');djslider.css('opacity',1);if(o.show_buttons>0){play_width=getSize($('#play'+o.id)).x;$('#play'+o.id).css('margin-left',-play_width/2);pause_width=getSize($('#pause'+o.id)).x;$('#pause'+o.id).css('margin-left',-pause_width/2);if(A){$('#play'+o.id).css('display','none')}else{$('#pause'+o.id).css('display','none')}}slidePlay()}function support(p){var b=document.body||document.documentElement,s=b.style;if(typeof s=='undefined')return false;if(typeof s[p]=='string')return p;v=['Moz','Webkit','Khtml','O','ms','Icab'],pu=p.charAt(0).toUpperCase()+p.substr(1);for(var i=0;i<v.length;i++){if(typeof s[v[i]+pu]=='string')return('-'+v[i].toLowerCase()+'-'+p)}return false}function updateTabindex(){t.each(function(a){if(o.slider_type=='down'){a=t.length-a-1}var b=$(this).find('a[href], input, select, textarea, button');if(a>=z&&a<z+parseInt(w)){b.each(function(){$(this).removeProp('tabindex')})}else{b.each(function(){$(this).prop('tabindex','-1')})}})}if(o.preload)setTimeout(sliderLoaded,o.preload);else $(window).load(sliderLoaded);responsive();$(window).on('resize',responsive);$(window).on('load',responsive)};this.init(F,G)};$.fn.djswipe=$.fn.djswipe||function(b){var c=false,originalPosition=null,info=null;$el=$(this);function swipeInfo(a){var x=a.originalEvent.touches[0].pageX,y=a.originalEvent.touches[0].pageY,dx,dy;dx=(x>originalPosition.x)?"right":"left";dy=(y>originalPosition.y)?"down":"up";return{direction:{x:dx,y:dy},offset:{x:Math.abs(x-originalPosition.x),y:Math.abs(originalPosition.y-y)}}}$el.on("touchstart",function(a){c=true;originalPosition={x:a.originalEvent.touches[0].pageX,y:a.originalEvent.touches[0].pageY}});$el.on("touchend",function(){c=false;if(info)b(info.direction,info.offset);originalPosition=null;info=null});$el.on("touchmove",function(a){if(!c){return}info=swipeInfo(a)});return true}})(jQuery);